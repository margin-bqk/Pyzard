# Pyzard - 🍕文件管理工具

## 项目简介

Pyzard 是一个基于Python开发的强大文件管理工具，提供多种文件操作功能，包括搜索、复制、剪切、重命名、文件夹提取等。支持冲突处理、操作撤回、历史记录等高级功能。

### 主要功能
- 🔍 **搜索并复制/剪切匹配的文件**
- 📁 **提取整个文件夹到指定目录**
- ✏️ **重命名文件（使用绝对路径）**
- 📄 **从CSV路径复制文件到目标文件夹**
- 📊 **导出目录结构到CSV**
- ↩️ **撤回上一次操作**
- ⚡ **智能冲突处理机制**

### 适用场景
- 批量文件整理和分类
- 项目文件迁移和备份
- 文件批量重命名
- 目录结构分析和导出
- 自动化文件管理任务

---

## 系统要求

### 基本要求
- **Python**: 3.6 或更高版本
- **操作系统**: Windows 7/8/10/11, Linux, macOS
- **内存**: 至少 512MB RAM
- **磁盘空间**: 至少 100MB 可用空间

### 依赖库
- Python标准库（无需额外安装）
- 可选：PyInstaller（用于构建可执行文件）

---

## 详细使用教程

### 启动程序

双击运行 `Pyzard.py` 文件，您会看到一个简单的菜单界面：

```
==================================================
请选择要使用的功能:
1. 搜索并复制匹配的文件
2. 提取整个文件夹到指定目录
3. 撤回上一次操作
4. 重命名文件（绝对路径）
5. 从CSV路径复制文件到目标文件夹
6. 导出目录结构到CSV
7. 退出程序
```

**简单理解**：就像在餐厅点菜一样，您只需要输入数字选择想要的功能！

---

### 1. 搜索并复制匹配的文件

#### 这个功能是做什么的？
**简单说**：帮您在电脑里找到特定的文件，然后复制或移动到另一个地方，还可以顺便改个名字。

**举个例子**：您想把电脑里所有的"照片.jpg"文件都复制到"备份"文件夹，并改名为"我的照片.jpg"

#### 操作步骤：
1. **选择功能**：输入数字 `1` 然后按回车
2. **选择冲突处理**：如果遇到同名文件怎么办？（后面会详细解释）
3. **告诉程序去哪里找文件**：输入源文件夹路径，比如 `D:\我的文件`
4. **告诉程序放哪里**：输入目标文件夹路径，比如 `D:\备份文件`
5. **提供文件清单**：输入CSV文件路径，比如 `D:\文件清单.csv`
6. **记录结果**：输入一个CSV文件路径来保存操作结果
7. **选择操作方式**：复制（保留原文件）还是剪切（移动文件）
8. **等待完成**：程序会自动完成所有操作

#### CSV文件怎么写？（很简单！）
用Excel或记事本创建一个文件，内容如下：
```
原文件名,新文件名
照片.jpg,我的照片.jpg
文档.txt,重要文档.txt
报告.pdf,最终报告.pdf
```

**注意**：第一行是标题，下面每行写一个文件，左边是原文件名，右边是想要的新文件名

---

### 2. 提取整个文件夹到指定目录

#### 这个功能是做什么的？
**简单说**：帮您在电脑里找到特定的文件夹，然后把整个文件夹（包括里面的所有文件）复制或移动到另一个地方。

**举个例子**：您想把电脑里所有名为"项目"的文件夹都提取出来，放到一个统一的地方

#### 操作步骤：
1. **选择功能**：输入数字 `2`
2. **选择冲突处理**：如果遇到同名文件夹怎么办？
3. **告诉程序去哪里找**：输入源文件夹路径
4. **告诉程序放哪里**：输入目标文件夹路径
5. **提供文件夹清单**：输入CSV文件路径
6. **记录结果**：输入一个CSV文件路径来保存操作结果
7. **选择操作方式**：复制还是剪切
8. **等待完成**

#### CSV文件怎么写？
```
原文件夹名,新文件夹名
项目,项目备份
图片,照片集
文档,重要文件
```

---

### 3. 撤回上一次操作

#### 这个功能是做什么的？
**简单说**：就像电脑里的"撤销"按钮，如果您不小心操作错了，可以用这个功能恢复到操作前的状态。

**重要提醒**：只能撤回最近一次成功的操作

#### 操作步骤：
1. **选择功能**：输入数字 `3`
2. **等待完成**：程序会自动撤回最近的操作

---

### 4. 重命名文件（绝对路径）

#### 这个功能是做什么的？
**简单说**：帮您批量重命名文件，需要您提供每个文件的具体位置。

**举个例子**：您想把"D:\照片"文件夹里的几个文件改名

#### 操作步骤：
1. **选择功能**：输入数字 `4`
2. **选择冲突处理**
3. **提供文件清单**：输入CSV文件路径
4. **记录结果**：输入一个CSV文件路径
5. **等待完成**

#### CSV文件怎么写？
```
原文件完整路径,新文件完整路径
D:\照片\img1.jpg,D:\照片\2024年照片1.jpg
D:\照片\img2.jpg,D:\照片\2024年照片2.jpg
```

**注意**：这里需要写完整的文件路径，包括盘符和文件夹

---

### 5. 从CSV路径复制文件到目标文件夹

#### 这个功能是做什么的？
**简单说**：直接从CSV文件中读取文件位置，然后复制或移动到指定文件夹。

**适合场景**：您已经知道具体要操作哪些文件，直接告诉程序文件在哪里

#### 操作步骤：
1. **选择功能**：输入数字 `5`
2. **选择冲突处理**
3. **提供文件清单**：输入CSV文件路径
4. **选择操作方式**：复制还是剪切
5. **等待完成**

#### CSV文件怎么写？
```
原文件完整路径,目标文件夹
D:\文件\报告.doc,D:\备份
C:\文档\合同.pdf,C:\重要文件
```

---

### 6. 导出目录结构到CSV

#### 这个功能是做什么的？
**简单说**：帮您把一个文件夹里的所有文件和子文件夹信息整理成一个表格文件。

**有什么用**：可以清楚地看到文件夹里有什么，文件有多大，什么时候修改的

#### 操作步骤：
1. **选择功能**：输入数字 `6`
2. **选择要分析的文件夹**：输入文件夹路径
3. **指定输出文件**：输入CSV文件路径
4. **选择是否深入子文件夹**：是（分析所有子文件夹）还是否（只分析当前文件夹）
5. **等待完成**

#### 导出的表格包含：
- 文件/文件夹名称
- 类型（文件还是文件夹）
- 完整路径
- 文件大小
- 最后修改时间
- 在文件夹中的层级

---

## 冲突处理模式（简单解释）

当程序遇到同名文件时，您可以选择如何处理：

| 模式 | 说明 | 适合什么时候用 |
|------|------|----------------|
| `skip` | 跳过冲突文件 | 不想覆盖重要文件时 |
| `overwrite` | 覆盖现有文件 | 确定要更新文件时 |
| `copy` | 创建副本 | 想保留所有版本时 |
| `merge` | 合并文件夹内容 | 处理文件夹时合并内容 |

**推荐使用**：`copy`（创建副本）模式，这样不会丢失任何文件

---

## 示例教程

### 示例1：批量复制并重命名文件

**场景**：将项目中的文档文件复制到备份目录并重命名

1. **准备CSV文件** (`files.csv`):
   ```
   原文件名,新文件名
   readme.txt,README_FINAL.txt
   config.json,config_backup.json
   data.csv,data_archive.csv
   ```

2. **执行操作**:
   - 选择功能 `1`
   - 源路径: `D:\MyProject`
   - 目标路径: `D:\Backup`
   - CSV文件: `D:\files.csv`
   - 冲突模式: `copy`
   - 操作模式: 复制

3. **结果**：文件被复制到备份目录并重命名

### 示例2：提取特定文件夹

**场景**：从多个项目中提取所有"src"文件夹到统一目录

1. **准备CSV文件** (`folders.csv`):
   ```
   原文件夹名,新文件夹名
   src,Project1_src
   src,Project2_src
   src,Project3_src
   ```

2. **执行操作**:
   - 选择功能 `2`
   - 源路径: `D:\Projects`
   - 目标路径: `D:\AllSources`
   - CSV文件: `D:\folders.csv`
   - 冲突模式: `copy`
   - 操作模式: 复制

3. **结果**：所有src文件夹被提取并重命名

### 示例3：批量重命名文件

**场景**：重命名图片文件，添加日期前缀

1. **准备CSV文件** (`rename.csv`):
   ```
   原文件完整路径,新文件完整路径
   D:\Photos\image1.jpg,D:\Photos\20240115_image1.jpg
   D:\Photos\image2.jpg,D:\Photos\20240115_image2.jpg
   D:\Photos\image3.jpg,D:\Photos\20240115_image3.jpg
   ```

2. **执行操作**:
   - 选择功能 `4`
   - CSV文件: `D:\rename.csv`
   - 冲突模式: `copy`

3. **结果**：文件被重命名并保留原文件副本

### 示例4：导出目录结构

**场景**：分析项目文件结构

1. **执行操作**:
   - 选择功能 `6`
   - 目标目录: `D:\MyProject`
   - 输出CSV: `D:\project_structure.csv`
   - 递归遍历: 是

2. **结果**：生成包含完整目录结构的CSV文件

---

## 常见问题解答

### Q: 什么是CSV文件？怎么创建？
A: CSV文件就是简单的表格文件，可以用Excel创建，也可以用记事本创建。用逗号分隔每列内容。

### Q: 程序提示"文件不存在"怎么办？
A: 检查您输入的路径是否正确，确保文件确实存在。

### Q: 操作失败了怎么办？
A: 可以使用"撤回上一次操作"功能恢复到操作前的状态。

### Q: 程序运行很慢怎么办？
A: 如果操作的文件很多或很大，程序需要一些时间处理，请耐心等待。

### Q: 如何知道操作是否成功？
A: 程序会显示详细的操作结果，告诉您哪些文件处理成功，哪些失败。

---

## 高级功能（了解即可）

### 操作历史记录
- 所有操作自动记录，可以查看操作历史
- 支持操作状态跟踪

### 备份和恢复
- 剪切和重命名操作自动创建备份
- 支持从备份恢复文件

### 智能编码检测
- 自动识别CSV文件编码
- 支持中文文件名

---

## 故障排除

### 常见问题
- **CSV文件读取失败**：检查文件编码，建议使用UTF-8编码
- **文件操作权限不足**：以管理员身份运行程序
- **目标目录不存在**：程序会自动创建目标目录
- **撤回操作失败**：检查备份文件是否存在

---

## 支持

如有问题或建议，请通过以下方式联系：
- GitHub Issues: [项目Issues页面](https://github.com/margin-bqk/PySuperExtract/issues)
- 邮箱: margin_bqk@163.com

---

**Pyzard - 让文件管理更简单高效！** 🚀

*温馨提示：第一次使用时建议先用一些测试文件练习，熟悉后再处理重要文件。*
